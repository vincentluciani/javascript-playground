var encourageIfPassedTarget=function(e,t){e==t&&(document.getElementById("positive-message").style.display="flex",document.getElementById("positive-message-title").innerHTML=buildCongratulationTitle("en_US")+" :)",document.getElementById("positive-message-subtitle").innerHTML=buildCongratulationSubTitle("en_US"))},closeMessage=function(){document.getElementById("positive-message").style.display="none"},buildCongratulationTitle=function(e){var t=translations[e].amazing;return t[getRandomNumber(0,t.length-1)]},buildCongratulationSubTitle=function(e){var t=translations[e].encouraging;return t[getRandomNumber(0,t.length-1)]},addHabitElement=function(e){const t=document.createElement("div");t.setAttribute("habitDescription",e.habitDescription),t.setAttribute("target",e.target),t.setAttribute("class","box habit-setting"),t.setAttribute("id",e.habitId.toString()),t.setAttribute("habitId",e.habitId),t.setAttribute("weekDay",e.weekDay),t.setAttribute("isNegative",e.isNegative);const n=document.createTextNode("Update habit:");var r=document.createElement("i");r.setAttribute("class","fa fa-tasks");const a=document.createElement("div");a.appendChild(r),a.appendChild(n),a.setAttribute("class","habit-title");const s=document.createTextNode("Habit description:"),i=document.createElement("div");i.appendChild(s);const o=document.createElement("textarea");o.value=e.habitDescription,o.setAttribute("class","habit-description-definition large"),o.setAttribute("rows",3);const d=document.createTextNode("Daily Target:"),l=document.createElement("div");l.appendChild(d);const u=document.createElement("input");u.setAttribute("class","habit-target-definition"),u.setAttribute("type","number"),u.value=e.target,t.appendChild(a),t.appendChild(i),t.appendChild(o),t.appendChild(l),t.appendChild(u);var c=dynamicWeekDaySelector(e.weekDay);t.appendChild(c);const g=document.createElement("div");var m="saveChangesInHabit("+e.habitId.toString()+")";g.setAttribute("onClick",m),g.setAttribute("class","add-button"),g.innerHTML='<i class="fa fa-save"></i> Save',t.appendChild(g);const p=document.createElement("div");var y="requestHabitDeletion("+e.habitId.toString()+")";p.setAttribute("onClick",y),p.setAttribute("class","add-button"),p.innerHTML='<i class="fa fa-trash"></i> Delete',t.appendChild(p),document.getElementById("habits-definition-container").appendChild(t)},closeDeleteMessage=function(){document.getElementById("delete-message").style.display="none"},requestHabitDeletion=function(e){document.getElementById("delete-message").style.display="flex";var t="closeDeleteMessage();deleteHabitAndProgress("+e+")";document.getElementById("confirm-deletion-button").setAttribute("onclick",t)},deleteHabitAndProgress=function(e){deleteHabit(e),deleteProgressFromHabitToday(e)},deleteHabit=function(e){var t="habit-"+e.toString(),n=document.getElementById(e.toString());n.parentNode.removeChild(n),window.localStorage.removeItem(t)},deleteProgressFromHabitToday=function(e){for(var t=document.getElementsByClassName("habit-update"),n=t.length-1;n>=0;n--){var r=t[n].getAttribute("habitid"),a=t[n].getAttribute("progressDate");if(currentDateTime.getFullYear().toString().padStart(2,"0")+"-"+(currentDateTime.getMonth()+1).toString().padStart(2,"0")+"-"+currentDateTime.getDate().toString().padStart(2,"0")==a&&r==e){var s=t[n].getAttribute("id");t[n].parentNode.removeChild(t[n]);var i="progress-"+s.toString();window.localStorage.removeItem(i)}}},displayJournalEditBox=function(){var e=document.getElementById("date-filter").value,t=document.getElementById("journal-edit-box"),n=document.getElementById("daily-journal"),r=getCurrentDateJournal(e);n.value="",r&&r.length>0&&(n.value=JSON.parse(r)),t.setAttribute("progressDate",e),t.style.display="flex"},getCurrentDateJournal=function(e){return window.localStorage.getItem("journal-"+e)},closeJournal=function(){var e=document.getElementById("journal-edit-box"),t=e.getAttribute("progressDate"),n=document.getElementById("daily-journal").value,r={id:"journal-"+t.toString(),value:JSON.stringify(n)};executePushToQueue(r),e.style.display="none"},convertJournalKeyToDateInt=function(e){var t=e.substring(8,12)+e.substring(13,15)+e.substring(16,19);return parseInt(t)},readJournal=function(e){if(0==e.length)return 0;e.sort(function(e,t){return convertJournalKeyToDateInt(t.key)-convertJournalKeyToDateInt(e.key)});for(var t=0;t<e.length;t++){var n=e[t].text;if(n.length>0){var r=document.createElement("br"),a=document.createElement("div"),s=document.createElement("div");s.innerHTML=e[t].key.substr(8),s.setAttribute("class","date-label");var i=document.createElement("div");i.innerHTML=n,i.setAttribute("class","text-label"),a.appendChild(s),a.appendChild(i),a.appendChild(r),document.getElementById("journal-container").appendChild(a)}}},addElement=function(e){const t=document.createElement("div");t.setAttribute("id",e.id),t.setAttribute("habitDescription",e.habitDescription),t.setAttribute("target",e.target),t.setAttribute("progressDate",e.progressDate),t.setAttribute("class","box habit-update"),t.setAttribute("isNew",e.isNew),t.setAttribute("habitId",e.habitId),t.setAttribute("isNegative",e.isNegative);document.createElement("div");const n=document.createTextNode(e.habitDescription),r=document.createElement("input"),a=document.createTextNode("Number of times completed:"),s=document.createTextNode("Check when completed:"),i=document.createTextNode("Percentage Completion:"),o=document.createElement("input"),d=document.createElement("div"),l=document.createTextNode(" of "+e.target),u=document.createElement("div");u.setAttribute("class","side-text"),u.appendChild(l);var c=0;null!=e.isNegative&&"true"==e.isNegative?e.numberOfCompletions<=e.target&&(c=100):c=Math.round(100*e.numberOfCompletions/e.target),o.setAttribute("class","number-of-completion"),d.setAttribute("class","percentage-completion"),d.setAttribute("progressDate",e.progressDate),d.innerHTML=c.toString();var g=document.createElement("div");g.setAttribute("class","habit-description");var m=document.createElement("i");m.setAttribute("class","fa fa-plus");var p=document.createElement("i");p.setAttribute("class","fa fa-tasks"),g.appendChild(p),g.appendChild(n),t.appendChild(g),t.appendChild(m);var y=document.createElement("div");y.setAttribute("class","progress-details");var b=document.createElement("div");if(b.setAttribute("class","progress-container"),e.target>1){o.setAttribute("type","number"),o.setAttribute("value",e.numberOfCompletions),b.appendChild(a);var h=document.createTextNode("+"),f=document.createElement("div");f.setAttribute("class","plus-button normal");var v=document.createTextNode("-"),E=document.createElement("div");f.appendChild(h),E.setAttribute("class","minus-button normal"),E.appendChild(v),f.addEventListener("click",function(e){return function(){var t=e.getElementsByClassName("number-of-completion")[0];addOneToProgress(t),refreshProgress(e),console.log("added progress:"),console.log(e),pushProgressToQueue(e)}}(t)),E.addEventListener("click",function(e){return function(){var t=e.getElementsByClassName("number-of-completion")[0];minusOneToProgress(t),refreshProgress(e),console.log("added progress"),console.log(e),pushProgressToQueue(e)}}(t)),y.appendChild(b),y.appendChild(E),y.appendChild(o),y.appendChild(f),y.appendChild(u)}else{b.appendChild(s);var I=document.createElement("label");I.setAttribute("class","custom-checkbox-container");var k=document.createElement("span");k.setAttribute("class","checkmark"),o.setAttribute("type","checkbox"),1==e.numberOfCompletions?(o.checked=!0,o.setAttribute("value","1")):(o.checked=!1,o.setAttribute("value","0")),o.addEventListener("click",function(e){return function(){var t=e.getElementsByClassName("number-of-completion")[0];1==t.checked?t.setAttribute("value","1"):t.setAttribute("value","0"),refreshProgress(e),console.log("added progress"),console.log(e),pushProgressToQueue(e)}}(t)),I.appendChild(o),I.appendChild(k),y.appendChild(b),y.appendChild(I)}var D=document.createElement("div");D.setAttribute("class","progress-container"),D.appendChild(i),y.appendChild(D),y.appendChild(d),t.appendChild(y),r.value=e.target,document.getElementById("habits-container").appendChild(t),t.addEventListener("change",function(e){return function(){refreshProgress(e),console.log("added progress"),console.log(e),pushProgressToQueue(e)}}(t)),m.addEventListener("click",function(e,t){return function(){toggleExpandCollapse(e,t)}}(m,y))},toggleExpandCollapse=function(e,t){const n=e.classList.toggle("fa-plus"),r=e.classList.toggle("fa-minus");t.style.display=n&&!r?"none":"block"},updateProgressOnRadial=function(e,t){circleRadius=t.containerHeight/2-t.strokeWidth;var n=document.getElementById(t.suffixForIds+"_background-circle"),r=document.getElementById(t.suffixForIds+"_progress-circle"),a=document.getElementById(t.suffixForIds+"_percentage-value");document.getElementById(t.suffixForIds+"_percentage-circle-container");if(a){a.innerHTML=e+" %";var s=(t.strokeWidth+circleRadius)/1.5+t.textLeftAdjustment;if(a.style.marginLeft=s.toString()+"px",r.style.stroke=t.progressColor,n.style.stroke=t.emptyColor,isNaN(e))e=100;else{n.setAttribute("r",circleRadius),r.setAttribute("r",circleRadius);var i=Math.PI*circleRadius*2;e<0&&(e=0),e>100&&(e=100);var o=(100-e)/100*i;r.setAttribute("stroke-dashoffset",o),window.setTimeout(function(){r.style.strokeDashoffset=o},50),r.setAttribute("stroke-dasharray",i),n.setAttribute("stroke-dasharray",i)}}},createProgressElements=function(e){var t=e.containerHeight/2-e.strokeWidth,n=document.getElementById(e.anchorDivId),r="http://www.w3.org/2000/svg";const a=document.createElement("div");a.setAttribute("id",e.suffixForIds+"_percentage-circle-container");const s=document.createElementNS(r,"svg");s.setAttributeNS(r,"id",e.suffixForIds+"_svg-progress-bar"),s.setAttributeNS(r,"z-index",-1);const i=document.createElementNS(r,"circle");i.setAttribute("id",e.suffixForIds+"_background-circle"),i.setAttribute("stroke-dashoffset","0");const o=document.createElementNS(r,"circle");o.setAttribute("id",e.suffixForIds+"_progress-circle"),o.setAttribute("fill","transparent"),o.setAttribute("stroke-dashoffset","0"),i.setAttribute("cx",e.containerHeight/2),i.setAttribute("cy",e.containerHeight/2),i.setAttribute("stroke-width",e.strokeWidth),i.setAttribute("fill","white"),o.setAttribute("cx",e.containerHeight/2),o.setAttribute("cy",e.containerHeight/2),o.setAttribute("stroke-width",e.strokeWidth);const d=document.createElement("div");d.setAttribute("id",e.suffixForIds+"_percentage-value"),d.innerHTML="0 %";var l=-1*(e.containerHeight-e.strokeWidth-t+e.fontSize/1.9+e.textTopAdjustment),u=(e.strokeWidth+t)/1.5+e.textLeftAdjustment;d.style.marginTop=l.toString()+"px",d.style.marginLeft=u.toString()+"px",d.style.fontSize=e.fontSize.toString()+"px",d.style.position="relative",s.setAttribute("height",e.containerHeight),s.setAttribute("width",e.containerHeight),s.style.transform="rotate(-90deg)",s.appendChild(i),s.appendChild(o),a.appendChild(s),a.appendChild(d),n.appendChild(a)},weekSelectionDiv=document.getElementById("week-day-selection"),mondayButtonInAddDiv=weekSelectionDiv.getElementsByClassName("monday")[0],tuesdayButtonInAddDiv=weekSelectionDiv.getElementsByClassName("tuesday")[0],wednesdayButtonInAddDiv=weekSelectionDiv.getElementsByClassName("wednesday")[0],thursdayButtonInAddDiv=weekSelectionDiv.getElementsByClassName("thursday")[0],fridayButtonInAddDiv=weekSelectionDiv.getElementsByClassName("friday")[0],saturdayButtonInAddDiv=weekSelectionDiv.getElementsByClassName("saturday")[0],sundayButtonInAddDiv=weekSelectionDiv.getElementsByClassName("sunday")[0];mondayButtonInAddDiv.addEventListener("click",function(e,t){return function(){setDayOfWeek(e,"monday",t)}}(weekSelectionDiv,mondayButtonInAddDiv)),tuesdayButtonInAddDiv.addEventListener("click",function(e,t){return function(){setDayOfWeek(e,"tuesday",t)}}(weekSelectionDiv,tuesdayButtonInAddDiv)),wednesdayButtonInAddDiv.addEventListener("click",function(e,t){return function(){setDayOfWeek(e,"wednesday",t)}}(weekSelectionDiv,wednesdayButtonInAddDiv)),thursdayButtonInAddDiv.addEventListener("click",function(e,t){return function(){setDayOfWeek(e,"thursday",t)}}(weekSelectionDiv,thursdayButtonInAddDiv)),fridayButtonInAddDiv.addEventListener("click",function(e,t){return function(){setDayOfWeek(e,"friday",t)}}(weekSelectionDiv,fridayButtonInAddDiv)),saturdayButtonInAddDiv.addEventListener("click",function(e,t){return function(){setDayOfWeek(e,"saturday",t)}}(weekSelectionDiv,saturdayButtonInAddDiv)),sundayButtonInAddDiv.addEventListener("click",function(e,t){return function(){setDayOfWeek(e,"sunday",t)}}(weekSelectionDiv,sundayButtonInAddDiv));var setDayOfWeek=function(e,t,n){var r=e.getAttribute("weekday"),a=r.split(" ");if(n.classList.contains("selected")){n.classList.remove("selected"),n.classList.add("unselected");const e=a.indexOf(t);e>-1&&a.splice(e,1)}else n.classList.add("selected"),n.classList.remove("unselected"),a.push(t);r=a.join(" "),e.setAttribute("weekday",r)},weekDayNumbers={1:"monday",2:"tuesday",3:"wednesday",4:"thursday",5:"friday",6:"saturday",0:"sunday"},isDayOfWeekInHabitWeeks=function(e,t){debugWrite("Checking if day of week is in habit week: getting current week day"),debugWrite(e.getDay());var n=e.getDay(),r=weekDayNumbers[n];debugWrite("Corresponding week day according to array:"),debugWrite(r);var a=t.split(" ");return debugWrite("Habit week days:"),debugWrite(a.toString()),a.indexOf(r)>-1},dynamicWeekDaySelector=function(e){var t=document.createElement("div");t.setAttribute("class","week-day-selection"),t.setAttribute("weekday",e);const n=document.createElement("label"),r=document.createTextNode("Applies to the following days of the week:");n.appendChild(r);var a=dayOfWeek("monday","M",e),s=dayOfWeek("tuesday","T",e),i=dayOfWeek("wednesday","W",e),o=dayOfWeek("thursday","T",e),d=dayOfWeek("friday","F",e),l=dayOfWeek("saturday","S",e),u=dayOfWeek("sunday","S",e);return addWeekDayListener(t,a,"monday"),addWeekDayListener(t,s,"tuesday"),addWeekDayListener(t,i,"wednesday"),addWeekDayListener(t,o,"thursday"),addWeekDayListener(t,d,"friday"),addWeekDayListener(t,l,"saturday"),addWeekDayListener(t,u,"sunday"),t.appendChild(n),t.appendChild(a),t.appendChild(s),t.appendChild(i),t.appendChild(o),t.appendChild(d),t.appendChild(l),t.appendChild(u),t},addWeekDayListener=function(e,t,n){t.addEventListener("click",function(e,t){return function(){setDayOfWeek(e,n,t)}}(e,t))},dayOfWeek=function(e,t,n){var r=document.createElement("div");if(1==isDayInListOfDaysString(e,n))var a="weekday "+e+" selected";else a="weekday "+e+" unselected";return r.setAttribute("class",a),r.innerHTML=t,r},isDayInListOfDaysString=function(e,t){return t.split(" ").indexOf(e)>-1},resetWeekDaySelector=function(e){e.setAttribute("weekday","");for(var t=e.getElementsByClassName("weekday"),n=0;n<t.length;n++)t[n].classList.remove("selected")};function getRandomNumber(e,t){var n=Math.random();return Math.floor(1e3*n)%2==0?randomNumber=Math.floor((t-e)*n+e):randomNumber=Math.ceil((t-e)*n+e),randomNumber}var translations={en_US:{amazing:["Amazing","Superb","Outstanding","Magnificient","Exceptional","Marvellous","Wonderful","Sublime","Supreme","Splendid","Fantastic","Awesome","Mind-blowing","Brilliant","Smashing","Spectacular","Spectaculous","Awesome"],encouraging:["A little effort each day adds up to big results!","You are stronger than you know!","You are capable of amazing things!","Believe in yourself and you will be unstoppable!","You are doing exactly what you should be doing!","You are being so strong and patient!","I admire how strong you are!","I cannot wait to see what you do next!","You are doing a great job!","You are getting stronger every day!","I am so proud of you!","You are on the right track!","You made it look easy!","You have super powers!"]}},resetMemory=function(){resetHabits(),resetProgress()},resetElement=function(e){for(var t=0;t<localStorage.length;t++){var n=localStorage.key(t);n.indexOf(e+"-")>=0&&window.localStorage.removeItem(n)}},resetProgress=function(){for(var e=document.getElementsByClassName("habit-update"),t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t]);resetElement("progress")},resetHabits=function(){for(var e=document.getElementsByClassName("habit-setting"),t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t]);resetElement("habit")},resetDebugging=function(){document.getElementById("debugging-text").innerHTML=""},debugWrite=function(e){document.getElementById("debugging-text").innerHTML+=e+"<br>"},getMemoryDetails=function(){for(var e=0;e<localStorage.length;e++){var t=localStorage.key(e);t.indexOf("habit")>=0?document.getElementById("memory-habit").innerHTML+=window.localStorage.getItem(t):t.indexOf("progress")>=0&&(document.getElementById("memory-progress").innerHTML+=window.localStorage.getItem(t))}},pushProgressToQueue=function(e){var t=readElement(e);encourageIfPassedTarget(t.numberOfCompletions,t.target);var n={id:"progress-"+t.id,value:JSON.stringify(t)};executePushToQueue(n)},pushProgressArrayToQueue=function(e){var t={id:"progress-"+e.id,value:JSON.stringify(e)};executePushToQueue(t)},pushHabitArrayToQueue=function(e){var t={id:"habit-"+e.habitId,value:JSON.stringify(e)};executePushToQueue(t)},executePushToQueue=function(e){console.log("pushing to queue:"),console.log(e);var t=updateQueue.length,n=updateQueue.pop();null!=n&&n.id!=e.id?(console.log("putting back previous"),updateQueue.push(n)):(console.log("did not put back previous:"),console.log(n)),updateQueue.push(e),console.log(updateQueue),console.log("size before push:"+t.toString()+" size after push:"+updateQueue.length.toString())},pushItemInQueue=function(e){updateQueue.push(e)},readQueueProgress=function(){for(;updateQueue.length>0;){var e=updateQueue.shift();console.log("reading from queue"),console.log(e),putInStorage(e.id,e.value);var t=new Date;document.getElementById("last-saved-information").innerHTML="Last saved: "+t.toLocaleTimeString(),document.getElementById("last-saved-information-habits").innerHTML="Last saved: "+t.toLocaleTimeString()}},putInStorage=function(e,t){try{window.localStorage.setItem(e,t)}catch(e){console.error(e),console.error("Problem writing progress:"+elementToProcess.id.toString()),console.error(currentOutput)}},loggedIn=!1,maxForNonLoggedIn=2e3,updateQueue=[],radialProgressParameters={strokeWidth:6,containerHeight:80,fontSize:15,textLeftAdjustment:-5,textTopAdjustment:7,progressColor:"rgb(245 184 1)",emptyColor:"rgb(240 221 165)",anchorDivId:"daily-summary",suffixForIds:"12345"},currentDateTime=new Date,currentDate=currentDateTime.getFullYear().toString().padStart(2,"0")+"-"+(currentDateTime.getMonth()+1).toString().padStart(2,"0")+"-"+currentDateTime.getDate().toString().padStart(2,"0"),plusButtonInAddDiv=document.getElementById("plus-in-add-div"),minusButtonInAddDiv=document.getElementById("minus-in-add-div"),newTargetDiv=document.getElementById("new-target");onload=function(){"use strict";var e=window.location.search;"true"==new URLSearchParams(e).get("debug")&&(document.getElementById("debug-section").style.display="block"),document.getElementById("date-filter").value=currentDate,createProgressElements(radialProgressParameters),getHabitProgress(),addEmptyProgressOnNewDay(currentDate,currentDateTime),saveLoop()};var saveLoop=function(){setInterval(extractElementsForUpdate,1e3)};plusButtonInAddDiv.addEventListener("click",function(e){return function(){addOneToProgress(e)}}(newTargetDiv)),minusButtonInAddDiv.addEventListener("click",function(e){return function(){minusOneToProgress(e)}}(newTargetDiv));var getHabitProgress=function(){loggedIn?getHabitProgressWhenLoggedIn():getHabitProgressWhenNotLoggedIn()},getHabitProgressWhenLoggedIn=function(){var e={method:"GET",url:"http://localhost:5000/get-habit-progress"};new APICaller(e,ingestElements,getHabitProgressWhenNotLoggedIn).executeCall(e.url,{})},getHabitProgressWhenNotLoggedIn=function(){for(var e=[],t=[],n=[],r=0;r<localStorage.length&&r<maxForNonLoggedIn;r++){var a=localStorage.key(r);a.indexOf("progress-")>=0?e.push(JSON.parse(localStorage.getItem(a))):a.indexOf("habit-")>=0?t.push(JSON.parse(localStorage.getItem(a))):a.indexOf("journal-")>=0&&n.push({key:a,text:JSON.parse(localStorage.getItem(a))})}t.length>1?changeTabToProgress():t.length>0?(changeTabToProgress(),hideGraphsTab()):(changeTabToHabits(),hideProgressTab(),hideGraphsTab(),hideSaveButtonOnHabits(),hideStartProgressButtonOnHabits()),n.length<1&&hideJournalBox(),ingestElements(e,t,n)},hideJournalBox=function(){document.getElementById("journal-container").innerHTML="no entry yet"},hideProgressTab=function(){document.getElementById("progress-menu").style.display="none"},showProgressTab=function(){document.getElementById("progress-menu").style.display="block"},hideGraphsTab=function(){document.getElementById("graphs-menu").style.display="none"},showGraphsTab=function(){document.getElementById("graphs-menu").style.display="block"},hideSaveButtonOnHabits=function(){},showSaveButtonOnHabits=function(){},hideStartProgressButtonOnHabits=function(){document.getElementById("go-to-progress-button").style.display="none"},showStartProgressButtonOnHabits=function(){document.getElementById("go-to-progress-button").style.display="flex"},ingestElements=function(e,t,n,r){for(var a=0;a<e.length;a++)addElement(e[a]);for(a=0;a<t.length;a++)addHabitElement(t[a]);applyFilters(),launchCharts(e,t),readJournal(n)},filterDivs=function(e,t,n,r){if(null!=n&&""!=n)for(var a=0;a<e.length;a++){var s=e[a].getAttribute(t);s==n&&r||s.indexOf(n)>=0&&!r||(e[a].style.display="none")}},resetElements=function(){for(var e=document.getElementsByClassName("habit-update"),t=0;t<e.length;t++){e[t].style.display="block";var n=e[t],r=n.getElementsByClassName("number-of-completion")[0];null!=r&&(refreshProgress(n),r.addEventListener("change",function(e){return function(){refreshProgress(e)}}(n)))}return e},refreshProgress=function(e){var t=e.getElementsByClassName("number-of-completion")[0],n=0,r=e.getAttribute("isNegative");null!=r&&"true"==r?t.value<=parseInt(e.getAttribute("target"))&&(n=100):n=Math.round(100*t.value/parseInt(e.getAttribute("target"))),e.getElementsByClassName("percentage-completion")[0].innerHTML=n,putColorBasedOnCompletion(e,n),updateDailyProgress()},putColorBasedOnCompletion=function(e,t){t>=100?(e.style.border="1px solid rgb(167 211 162)",e.style.order="95",e.style.background="#daffd9"):t>=50?(e.style.border="1px solid rgb(246 223 35)",e.style.background="rgb(255 251 234)",e.style.order="70"):t<50&&(e.style.border="1px solid lightgrey",e.style.background="white",e.style.order="70"),e.id&&"daily-summary-container"==e.id&&(e.style.order="90")},updateDailyProgress=function(){for(var e=document.getElementsByClassName("percentage-completion"),t=document.getElementById("date-filter").value,n=0,r=0,a=0;a<e.length;a++){if(e[a].getAttribute("progressDate")==t){var s=parseInt(e[a].innerHTML);n+=s=s>100?100:s,r++}}var i=Math.round(n/r),o=document.getElementById("daily-summary"),d=document.getElementById("daily-summary-container"),l=document.getElementById("daily-summary-comment");if(i&&i>0)i>=100?(radialProgressParameters.progressColor="rgb(167, 211, 162)",radialProgressParameters.emptyColor="rgb(193 236 205)",l.innerHTML="Awesome Achievement !"):i>=50?(radialProgressParameters.progressColor="rgb(238 230 168)",radialProgressParameters.emptyColor="rgb(228 228 228)",l.innerHTML="You are almost there !"):(radialProgressParameters.progressColor="#b657af",radialProgressParameters.emptyColor="rgb(255 217 235)",l.innerHTML="Good Start<br>Keep it up !"),radialProgressParameters.textLeftAdjustment=i>=100?-9:i>=10?-5:-2,updateProgressOnRadial(i,radialProgressParameters),d.style.display="block";else{i=0;d.style.display="none"}putColorBasedOnCompletion(o.parentNode,i)},applyFilters=function(){var e=resetElements(),t=document.getElementById("text-filter").value,n=document.getElementById("date-filter").value;filterDivs(e,"progressDate",n,!0),filterDivs(e,"habitDescription",t,!1)},dateFilter=document.getElementById("date-filter");dateFilter.addEventListener("input",function(e){applyFilters(),createMissingElementsForDate(this.value)});var textFilter=document.getElementById("text-filter");textFilter.addEventListener("input",function(e){applyFilters()});var createMissingElementsForDate=function(e){var t=e.split("-"),n=new Date(t[0],(parseInt(t[1])-1).toString(),t[2],0,0,0,0);debugWrite("Creating missing progress elements for date:"+e.toString()+" time:"+n.toString()),addEmptyProgressOnNewDay(e,n)},minusOneToProgress=function(e){console.log("minus one"),parseInt(e.value)>0&&(e.value=(parseInt(e.value)-1).toString())},addOneToProgress=function(e){console.log("plus one"),e.value=(parseInt(e.value)+1).toString()},addElementFromForm=function(){var e={};e.id=Date.now(),e.habitId=10*e.id,e.habitDescription=document.getElementById("new-description").value,e.target=parseInt(document.getElementById("new-target").value),e.isNegative=document.getElementById("new-is-negative-flag").checked,e.progressDate=currentDate,e.numberOfCompletions=0,e.isNew=!0;var t=document.getElementById("week-day-selection");if(e.weekDay=t.getAttribute("weekDay"),e.weekDay)var n=isDayOfWeekInHabitWeeks(currentDateTime,e.weekDay);else n=!0;null!=n&&1==n&&addElement(e),addHabitElement(e),pushProgressArrayToQueue(e),document.getElementById("new-description").value=null,document.getElementById("new-target").value=1,document.getElementById("new-is-negative-flag").checked=!1,resetWeekDaySelector(t),showProgressTab(),showSaveButtonOnHabits(),showStartProgressButtonOnHabits(),saveChangesInHabitFromObject(e),confirmAddition(e.habitId)},saveChangesInHabit=function(e){var t=document.getElementById(e),n=readHabitElement(t);pushHabitArrayToQueue(n)},saveChangesInHabitFromObject=function(e){var t={};t.habitId=e.habitId,t.isNegative=e.isNegative,t.habitDescription=e.habitDescription,t.target=e.target,t.weekDay=e.weekDay,pushHabitArrayToQueue(t)},closeAdditionConfirmation=function(){document.getElementById("addition-message").style.display="none"},confirmAddition=function(e){document.getElementById("addition-message").style.display="flex";var t="closeAdditionConfirmation();document.getElementById("+e+").scrollIntoView();";document.getElementById("check-habit-button").setAttribute("onclick",t)},displayAllElements=function(e){for(var t=0;t<e.length;t++){const e=document.createElement("div");document.body.appendChild(e)}},extractElementsForUpdate=function(){console.log("saving");var e=document.getElementsByClassName("habit-update"),t=document.getElementsByClassName("habit-setting");loggedIn?extractElementsForUpdateLoggedIn(e,t):extractElementsForUpdateNoneLoggedIn(e,t)},extractElementsForUpdateLoggedIn=function(e,t){for(var n=[],r=0;r<e.length&&r<maxForNonLoggedIn;r++){var a=readElement(e[r]);n.push(a)}console.log(n)},extractElementsForUpdateNoneLoggedIn=function(e,t){readQueueProgress()},readHabitElement=function(e){var t={};return t.habitId=e.getAttribute("habitId"),t.isNegative=e.getAttribute("isNegative"),t.habitDescription=e.getElementsByClassName("habit-description-definition")[0].value,t.target=parseInt(e.getElementsByClassName("habit-target-definition")[0].value),t.weekDay=e.getElementsByClassName("week-day-selection")[0].getAttribute("weekDay"),t},readElement=function(e){var t={};return t.id=e.getAttribute("id"),t.habitId=e.getAttribute("habitId"),t.habitDescription=e.getAttribute("habitDescription"),t.target=parseInt(e.getAttribute("target")),t.progressDate=e.getAttribute("progressDate"),t.isNew=e.getAttribute("isNew"),t.isNegative=e.getAttribute("isNegative"),t.numberOfCompletions=parseInt(e.getElementsByClassName("number-of-completion")[0].value),t};function APICaller(e,t,n){this.parameters=e,this.callback=t,this.executeCall=function(r,a){var s=new XMLHttpRequest;s.onreadystatechange=function(){4==this.readyState&&200==this.status?t(JSON.parse(this.responseText),a):n()},s.open(e.method,r,!0),s.send()}}var addEmptyProgressOnNewDay=function(e,t){var n=(new Date).setHours(0,0,0,0);if(!(t.setHours(0,0,0,0)>n))for(var r=document.getElementsByClassName("habit-update"),a=document.getElementsByClassName("habit-setting"),s=0;s<a.length;s++){for(var i=!1,o=0;o<r.length;o++)a[s].getAttribute("habitId")==r[o].getAttribute("habitId")&&r[o].getAttribute("progressdate")==e&&(i=!0);if(0==i){if(a[s].getAttribute("weekDay")){debugWrite("Comparing currrent date time with habit week day"),debugWrite("Current date time:"),debugWrite(t),debugWrite("Habit week day:"),debugWrite(a[s].getAttribute("weekDay"));var d=isDayOfWeekInHabitWeeks(t,a[s].getAttribute("weekDay"))}else d=!0;null!=d&&1==d&&(newProgressObject={id:100*Date.now()+s,habitId:a[s].getAttribute("habitId"),habitDescription:a[s].getAttribute("habitDescription"),target:a[s].getAttribute("target"),progressDate:e,isNew:!0,numberOfCompletions:0},addElement(newProgressObject),console.log("added progress"),console.log(newProgressObject),pushProgressArrayToQueue(newProgressObject))}}},launchCharts=function(e,t){for(var n=0;n<t.length;n++)launchChart(e,t[n])},changeTabToProgress=function(){document.getElementById("habits-section").style.display="none",document.getElementById("progress-section").style.display="block",document.getElementById("graphs-section").style.display="none",document.getElementById("progress-menu").classList.add("active"),document.getElementById("habits-menu").classList.remove("active"),document.getElementById("graphs-menu").classList.remove("active")},changeTabToHabits=function(){document.getElementById("habits-section").style.display="block",document.getElementById("progress-section").style.display="none",document.getElementById("graphs-section").style.display="none",document.getElementById("progress-menu").classList.remove("active"),document.getElementById("habits-menu").classList.add("active"),document.getElementById("graphs-menu").classList.remove("active"),document.getElementById("new-description").focus()},changeTabToGraphs=function(){document.getElementById("habits-section").style.display="none",document.getElementById("progress-section").style.display="none",document.getElementById("graphs-section").style.display="block",document.getElementById("progress-menu").classList.remove("active"),document.getElementById("habits-menu").classList.remove("active"),document.getElementById("graphs-menu").classList.add("active")},launchChart=function(e,t){for(var n=[],r=[],a=0;a<e.length;a++)e[a].habitId==t.habitId&&(n.push({x:new Date(e[a].progressDate),y:e[a].numberOfCompletions}),r.push({x:new Date(e[a].progressDate),y:e[a].target}));n.sort(function(e,t){return e.x-t.x}),n.length>=1&&showGraphsTab(),r.sort(function(e,t){return e.x-t.x});var s=0;for(a=n.length-1;a>=0;a--){var i=n[a].x;if(i.getFullYear()!==currentDateTime.getFullYear()||i.getMonth()!==currentDateTime.getMonth()||i.getDate()!==currentDateTime.getDate()){if(n[a].y<r[a].y)break;s++}else n[a].y>=r[a].y&&s++}var o,d={},l=0,u=n.length-1;if(u<0)return!1;if(!(u>=0&&n[u]&&n[u].x))return!1;debugWrite("Launching Chart"),debugWrite(n[u].x.getDay());var c=n[u].x.getDay();n[u].y>=r[u].y?o="<i class='fa fa-circle icon'></i>":(i=n[u].x).getFullYear()==currentDateTime.getFullYear()&&i.getMonth()==currentDateTime.getMonth()&&i.getDate()==currentDateTime.getDate()||(o="x",l++),d[c]=null!=o?o:" ";do{if(--u<0)break;if(u>=0&&n[u]&&n[u].x){var g=n[u].x.getDay();if(0!=c){if(g>c||0==g)break}else if(0==g)break;n[u].y>=r[u].y?o="<i class='fa fa-circle icon'></i>":(o="x",l++),null==d[g]&&(d[g]=null!=o?o:" ")}}while(g>1);var m="<table><tr><th>M</th><th>T</th><th>W</th><th>T</th><th>F</th><th>S</th><th>S</th></tr>";m+="<tr><td>"+getElementToPutOnTable(d[1])+"</td><td>"+getElementToPutOnTable(d[2])+"</td><td>"+getElementToPutOnTable(d[3])+"</td><td>"+getElementToPutOnTable(d[4])+"</td><td>"+getElementToPutOnTable(d[5])+"</td><td>"+getElementToPutOnTable(d[6])+"</td><td>"+getElementToPutOnTable(d[0])+"</td></tr></table>";var p=document.createElement("canvas"),y=document.createElement("div"),b=document.createElement("div"),h=document.createElement("br");const f=document.createTextNode(t.habitDescription),v=document.createElement("div"),E=document.createTextNode(t.habitDescription),I=document.createElement("div"),k=document.createElement("div");var D=document.createElement("i");D.setAttribute("class","fa fa-calendar");var A=document.createElement("i");A.setAttribute("class","fa fa-bar-chart");const C=document.createElement("div");C.innerHTML="Number of streaks: "+s.toString(),C.setAttribute("class","subtitle"),v.setAttribute("class","graph-title"),v.appendChild(D),v.appendChild(f),I.setAttribute("class","graph-title"),I.appendChild(A),I.appendChild(E);const B=document.createElement("div");B.innerHTML="This week summary:",B.setAttribute("class","subtitle"),k.setAttribute("class","table-summary"),k.innerHTML=m;const w=document.createElement("div");w.innerHTML="Graph:",w.setAttribute("class","subtitle"),p.setAttribute("id","graph-"+t.habitId),y.appendChild(v),b.appendChild(I),b.setAttribute("id","streaks-"+t.habitId),y.appendChild(k),y.appendChild(h),b.appendChild(C),b.appendChild(w),b.append(p),y.setAttribute("class","box canva-wrapper week-box"),b.setAttribute("class","box canva-wrapper streak-box"),0==l?(y.style.background="#daffd9",y.style.border="1px solid rgb(167 211 162)"):1==l?(y.style.background="rgb(255 252 238)",y.style.border="1px solid rgb(246 223 35)"):l>1&&(y.style.background="white"),s>=10?(b.style.background="#daffd9",b.style.border="1px solid rgb(167 211 162)"):s>=5?(b.style.background="rgb(255 252 238)",b.style.border="1px solid rgb(246 223 35)"):b.style.background="white",document.getElementById("no-graph").style.display="none",document.getElementById("no-streak").style.display="none",document.getElementById("graph-container").appendChild(y),document.getElementById("streaks-container").appendChild(b);var T=document.getElementById("graph-"+t.habitId).getContext("2d");s>=10?(graphBackgroundColor="#b5f7b1",graphColor="#3ce132"):s>=5?(graphBackgroundColor="rgb(255 249 202)",graphColor="rgb(235 209 0)"):(graphBackgroundColor="rgb(224 224 224)",graphColor="rgb(174 174 174)");let x={datasets:[{label:"Your daily score",data:n,backgroundColor:graphBackgroundColor,borderColor:graphColor,color:"blue",order:1}]};new Chart(T,{data:x,options:{responsive:!0,legend:{position:"bottom",display:!1},scales:{xAxes:[{type:"time",time:{parser:"YYYY-MM-DD",unit:"day"}}],yAxes:[{scaleLabel:{display:!0,labelString:"Progress",type:"line",suggestedMin:0,beginAtZero:!0}}]}},type:"line"})},getElementToPutOnTable=function(e){return e||" "},subMenuGo=function(e){window.scrollTo(0,0);var t=document.getElementById("journal-link"),n=document.getElementById("streaks-link"),r=document.getElementById("week-link"),a=document.getElementById("graph-container"),s=document.getElementById("streaks-container"),i=document.getElementById("journal-container-wrapper");switch(e){case"week-link":r.classList.add("selected-underline"),t.classList.remove("selected-underline"),n.classList.remove("selected-underline"),a.style.display="flex",s.style.display="none",i.style.display="none";break;case"streaks-link":r.classList.remove("selected-underline"),t.classList.remove("selected-underline"),n.classList.add("selected-underline"),a.style.display="none",s.style.display="flex",i.style.display="none";break;case"journal-link":r.classList.remove("selected-underline"),t.classList.add("selected-underline"),n.classList.remove("selected-underline"),a.style.display="none",s.style.display="none",i.style.display="flex"}};